
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Diffie Hellman (DH) Key Exchange &#8212; Days of Algo</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/customize.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/font_button.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://tschinz.github.io/days-of-algo/content/notebooks/012-diffie-hellman-key-exchange.html" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Enigma Virtual Machine" href="013-enigma-machine.html" />
    <link rel="prev" title="Maze Solver with A* Algorithm" href="011-maze-solver-astar.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/days-of-algo-icon.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Days of Algo</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01-index.html">
   Days of Algo
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../02-big_o.html">
   Big O notation
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../03-algorithms.html">
   Algorithms
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="000-hanoi-tower.html">
     Hanoi tower
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="001-matrix-chain-multiplication.html">
     Matrix Chain Multiplication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="002-permutations.html">
     All permutations and next permutation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="003-counting-1bits.html">
     Counting 1 Bits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="004-eratosthenes-sieve.html">
     Prime numbers with Eratosthenes sieve
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="005-binary-addition-fsm.html">
     Binary addition FSM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="006-binary-search.html">
     Binary Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="007-union-find.html">
     Union-find
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="008-maze-generation-kruskal.html">
     Maze Generation (Kruskal’s Algorithm)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="009-maze-solver-lee.html">
     Maze Solver with Lee’s Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="010-maze-solver-dijkstra.html">
     Maze Solver with Dijkstra’s Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="011-maze-solver-astar.html">
     Maze Solver with A* Algorithm
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Diffie Hellman (DH) Key Exchange
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="013-enigma-machine.html">
     Enigma Virtual Machine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="014-sorting-algorithms.html">
     Sorting Algorithms
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <button type="button" onclick="legibleFontSwitcher()">Switch Font</button>&nbsp;&nbsp;<button type="button" onclick="fontScaler(1.1)">&#10133;</button><button type="button" onclick="fontScaler(0.0)">&#9679;</button><button type="button" onclick="fontScaler(0.909)">&#10134;</button>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/notebooks/012-diffie-hellman-key-exchange.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/tschinz/days-of-algo"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/tschinz/days-of-algo/issues/new?title=Issue%20on%20page%20%2Fcontent/notebooks/012-diffie-hellman-key-exchange.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/tschinz/days-of-algo/edit/master/jupyterbook/content/notebooks/012-diffie-hellman-key-exchange.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/tschinz/days-of-algo/master?urlpath=lab/tree/jupyterbook/content/notebooks/012-diffie-hellman-key-exchange.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/tschinz/days-of-algo/blob/master/jupyterbook/content/notebooks/012-diffie-hellman-key-exchange.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#terminology">
   Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithm">
   Algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test">
   Test
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Diffie Hellman (DH) Key Exchange</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#terminology">
   Terminology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithm">
   Algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test">
   Test
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="diffie-hellman-dh-key-exchange">
<h1>Diffie Hellman (DH) Key Exchange<a class="headerlink" href="#diffie-hellman-dh-key-exchange" title="Permalink to this headline">¶</a></h1>
<div class="figure align-default" id="diffie-hellman-key-exchange">
<a class="reference internal image-reference" href="../../_images/012-diffie_hellman_key_exchange.svg"><img alt="../../_images/012-diffie_hellman_key_exchange.svg" src="../../_images/012-diffie_hellman_key_exchange.svg" width="40%" /></a>
<p class="caption"><span class="caption-number">Fig. 30 </span><span class="caption-text">Diffie Hellman Key Exchange Example</span><a class="headerlink" href="#diffie-hellman-key-exchange" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">Diffie-Hellman Key Exchange</a> (DH) is a very widely used method to exchange cryptographic keys. The private keys are not actually exchanged, they are jointly derived. They were invented and published by Whitfield Diffie and Martin Hellman in 1976.</p>
<p>In an encrypted communication channel an <a class="reference external" href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">symmetric key</a> is used, this means both parties need the same encryption key for either encrypting or decrypting the messages. DH allows to infer this key without the public exchange of it.</p>
<p>The algorithm is based on Elliptic Curve Cryptography, a method of doing public-key cryptography based on algebra structure of elliptic curves over finite fields.</p>
<p>It is based on the principle that:</p>
<div class="math notranslate nohighlight">
\[ A = g^{a}\;mod\;p \]</div>
<div class="math notranslate nohighlight">
\[ B = g^{b}\;mod\;p \]</div>
<div class="math notranslate nohighlight">
\[ A^b\;mod\;p = g^{ab}\;mod\;p = g^{ba}\;mod\;p = B^a\;mod\;p \]</div>
<p>The resulting key for the Diffie Hellman Key Exchange can be then used to any data encryption such as AES, Blowfish etc.</p>
<div class="section" id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>private key - <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> secret integer specific for each end between 1 and the prime number <span class="math notranslate nohighlight">\(p\)</span>. Also called secret.</p></li>
<li><p>public key - <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> generated key derived from the private key to be shared</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> or <span class="math notranslate nohighlight">\(b\)</span> - called generator or base. It is a <a class="reference external" href="https://en.wikipedia.org/wiki/Primitive_root_modulo_n">primitive root modulo</a> or a small prime number.</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> - big <a class="reference external" href="https://en.wikipedia.org/wiki/Prime_number">prime number</a> often between 2048 and 4096 bits long</p></li>
</ul>
</div>
<div class="section" id="algorithm">
<h2>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>The first party (Alice) picks two numbers, <span class="math notranslate nohighlight">\(g\)</span> a <a class="reference external" href="https://en.wikipedia.org/wiki/Primitive_root_modulo_n">primitive root modulo</a> and <span class="math notranslate nohighlight">\(p\)</span> a big <a class="reference external" href="https://en.wikipedia.org/wiki/Prime_number">prime number</a> and tells them to the second party</p></li>
<li><p>The second party (Bob) picks a secret number <span class="math notranslate nohighlight">\(a\)</span>, and then it computes <span class="math notranslate nohighlight">\(A = g^a\;mod\;p\)</span> and sends the result <span class="math notranslate nohighlight">\(A\)</span> back to the first party. The secret number <span class="math notranslate nohighlight">\(a\)</span> has not been sent only the calculation result.</p></li>
<li><p>Then the first party (Alice) does the same, it selects a secret number <span class="math notranslate nohighlight">\(b\)</span> and calculates <span class="math notranslate nohighlight">\(B = g^b\;mod\;p\)</span> and sends <span class="math notranslate nohighlight">\(B\)</span> to the second party (Bob)</p></li>
<li><p>The second party (Bob) takes the received number <span class="math notranslate nohighlight">\(B\)</span> and calculates <span class="math notranslate nohighlight">\(B^a\;mod\;p\)</span></p></li>
<li><p>The first party (Alice) takes the received number <span class="math notranslate nohighlight">\(A\)</span> and calculates <span class="math notranslate nohighlight">\(A^b\;mod\;p\)</span></p></li>
</ol>
<p><strong>Both parties will get the same result.</strong></p>
<div class="math notranslate nohighlight">
\[ (g^a\;mod\;p)^b\;mod\;p = g^{ab}\;mod\;p \]</div>
<div class="math notranslate nohighlight">
\[ (g^b\;mod\;p)^a\;mod\;p = g^{ba}\;mod\;p \]</div>
</div>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Algorithm<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1234</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">left</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Representing a end of the kexy exchange transmission</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        seed (int, optional): seed for initialising the random number generators. Defaults to 1234.</span>
<span class="sd">        name (string, optional): name of the person. Defaults to &quot;&quot;.</span>
<span class="sd">        left (bool, optional): bool indicating if its the left or right party (only used for prints). Defaults to True.</span>
<span class="sd">        verbose (bool, optional): being verbose or not. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_seed</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rand_gen</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rand_gen</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seed</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_left</span> <span class="o">=</span> <span class="n">left</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span> <span class="o">=</span> <span class="n">verbose</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="mi">40</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> is alive&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">))</span>
    
  <span class="k">def</span> <span class="nf">genPrimeNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generates a random prime number between the range x and y, very inefficient method</span>

<span class="sd">    Args:</span>
<span class="sd">        x (int): lower range bound</span>
<span class="sd">        y (int): higher range bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: random prime number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># generates list of prime numbers</span>
    <span class="n">_prime_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
      <span class="n">_isPrime</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">_isPrime</span> <span class="o">=</span> <span class="kc">False</span>

      <span class="k">if</span> <span class="n">_isPrime</span><span class="p">:</span>
        <span class="n">_prime_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># select a prime number</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rand_gen</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">_prime_list</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">genSecretKey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generates a random private key between 1 and prime $p$. Representing self._name[0].lower()&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_secret_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rand_gen</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> generated his secret key </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_secret_key</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">genPublicKey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generates the public variables (key) to be shared. Representing self._name[0].upper()</span>
<span class="sd">    </span>
<span class="sd">        Returns:</span>
<span class="sd">        int: shared publiuc key self._name.lower()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_secret_key</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> generated his public key </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span>

  <span class="k">def</span> <span class="nf">getPublicKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">public_key</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the other party public key</span>

<span class="sd">    Args:</span>
<span class="sd">        public_key (int): pubic key from partner</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">other_public_key</span> <span class="o">=</span> <span class="n">public_key</span>
  
  <span class="k">def</span> <span class="nf">genGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generates the public base $b$ or generator number $g$</span>

<span class="sd">        Returns:</span>
<span class="sd">        int: shared number $g$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genPrimeNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> generated shared base g: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span>

  <span class="k">def</span> <span class="nf">setGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;sets the base $b$ or generator $g$ number, if the other party has generated it</span>

<span class="sd">    Args:</span>
<span class="sd">        g (int): shared generator number</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: shared number $g$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">g</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span>

  <span class="k">def</span> <span class="nf">genPrime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generates a public prime number. This is way too small for reality, commonly 4096 bits</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: shared prime number $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genPrimeNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> generated shared prime p: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>

  <span class="k">def</span> <span class="nf">setPrime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;sets the prime number $p$, if the other party has generated it</span>

<span class="sd">    Args:</span>
<span class="sd">        p (int): shared prime number $p$</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: shared prime number $p$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>

  <span class="k">def</span> <span class="nf">genSharedSecret</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generates the common shared secret key</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: shared secret key</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_shared_secret</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">other_public_key</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">_secret_key</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> generated shared secret: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shared_secret</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="test">
<h2>Test<a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alice</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="mi">1234</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">bob</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="mi">4321</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># generate variables g and p</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">genGenerator</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">genPrime</span><span class="p">()</span>

<span class="c1"># share variables g and p</span>
<span class="n">bob</span><span class="o">.</span><span class="n">setGenerator</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">bob</span><span class="o">.</span><span class="n">setPrime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># create secrets keys</span>
<span class="n">alice</span><span class="o">.</span><span class="n">genSecretKey</span><span class="p">()</span>
<span class="n">bob</span><span class="o">.</span><span class="n">genSecretKey</span><span class="p">()</span>

<span class="c1"># create public keys</span>
<span class="n">alice_pubkey</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">genPublicKey</span><span class="p">()</span>
<span class="n">bob_pubkey</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">genPublicKey</span><span class="p">()</span>

<span class="c1"># Exchange keys</span>
<span class="n">alice</span><span class="o">.</span><span class="n">getPublicKey</span><span class="p">(</span><span class="n">bob_pubkey</span><span class="p">)</span>
<span class="n">bob</span><span class="o">.</span><span class="n">getPublicKey</span><span class="p">(</span><span class="n">alice_pubkey</span><span class="p">)</span>

<span class="c1"># Calculate shared secret which should be both times the same</span>
<span class="n">alice</span><span class="o">.</span><span class="n">genSharedSecret</span><span class="p">()</span>
<span class="n">bob</span><span class="o">.</span><span class="n">genSharedSecret</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Alice is alive
                                        Bob is alive
Alice generated shared base g: 43
Alice generated shared prime p: 257
Alice generated his secret key a: 4
                                        Bob generated his secret key b: 131
Alice generated his public key A: 187
                                        Bob generated his public key B: 163
Alice generated shared secret: 95
                                        Bob generated shared secret: 95
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="011-maze-solver-astar.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Maze Solver with A* Algorithm</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="013-enigma-machine.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Enigma Virtual Machine</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By tschinz with ❤️<br/>
    
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>